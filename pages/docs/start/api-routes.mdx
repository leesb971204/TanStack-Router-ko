---
id: api-routes
title: API Routes
---

## API Routes

API RoutesëŠ” TanStack Startì˜ ê°•ë ¥í•œ ê¸°ëŠ¥ìœ¼ë¡œ, ë³„ë„ì˜ ì„œë²„ ì—†ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì„œë²„ ì¸¡ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìžˆë„ë¡ í•©ë‹ˆë‹¤. API RoutesëŠ” í¼ ì œì¶œ, ì‚¬ìš©ìž ì¸ì¦ ë“±ì„ ì²˜ë¦¬í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ API RoutesëŠ” í”„ë¡œì íŠ¸ì˜ `./app/routes/api` ë””ë ‰í† ë¦¬ì— ì •ì˜ë˜ë©°, TanStack Start ì„œë²„ì— ì˜í•´ ìžë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.

> ðŸ§  ê¸°ë³¸ì ìœ¼ë¡œ API RoutesëŠ” `/api`ë¡œ ì ‘ë‘ì‚¬ê°€ ë¶™ìœ¼ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë™ì¼í•œ ì„œë²„ì—ì„œ ì œê³µë©ë‹ˆë‹¤. `apiBase`ë¥¼ TanStack Start ì„¤ì •ì—ì„œ ë³€ê²½í•˜ì—¬ ê¸°ë³¸ ê²½ë¡œë¥¼ ì‚¬ìš©ìž ì •ì˜í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì´ ê°€ì´ë“œì—ì„œ ë‹¤ë£¨ëŠ” ì£¼ì œ:

- [File Route Conventions](#file-route-conventions)
- [Nested Directories vs File-names](#nested-directories-vs-file-names)
- [Setting up the entry handler](#setting-up-the-entry-handler)
- [Defining an API Route](#defining-an-api-route)
- [Dynamic Path Params](#dynamic-path-params)
- [Wildcard/Splat Param](#wildcardsplat-param)
- [Handling requests with a body](#handling-requests-with-a-body)
- [Responding with JSON](#responding-with-json)
- [Using the `json` helper function](#using-the-json-helper-function)
- [Responding with a status code](#responding-with-a-status-code)
- [Setting headers in the response](#setting-headers-in-the-response)

## File Route Conventions

TanStack Startì—ì„œ API RoutesëŠ” TanStack Routerì™€ ë™ì¼í•œ íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ… ê·œì¹™ì„ ë”°ë¦…ë‹ˆë‹¤. ì¦‰, `routes` ë””ë ‰í† ë¦¬ì—ì„œ `api`ë¡œ ì ‘ë‘ì‚¬ê°€ ë¶™ì€ ê° íŒŒì¼ì´ API ë¼ìš°íŠ¸ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:

- `routes/api.users.ts`ëŠ” `/api/users`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `routes/api/users.ts`ë„ `/api/users`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `routes/api/users.index.ts`ë„ `/api/users`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `routes/api/users/$id.ts`ëŠ” `/api/users/$id`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `routes/api/users/$id/posts.ts`ëŠ” `/api/users/$id/posts`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `routes/api.users.$id.posts.ts`ë„ `/api/users/$id/posts`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- `routes/api/file/$.ts`ëŠ” `/api/file/$`ì— API ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

`api`ë¡œ ì ‘ë‘ì‚¬ê°€ ë¶™ì€ ë¼ìš°íŠ¸ íŒŒì¼ì€ í•´ë‹¹ API ë¼ìš°íŠ¸ ê²½ë¡œì— ëŒ€í•œ í•¸ë“¤ëŸ¬ë¡œ ìƒê°í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

â— ë¼ìš°íŠ¸ì—ëŠ” ë‹¨ì¼ í•¸ë“¤ëŸ¬ íŒŒì¼ë§Œ ì—°ê²°ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `routes/api/users.ts` íŒŒì¼ì´ `/api/users` ê²½ë¡œì™€ ì¼ì¹˜í•œë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ì€ ë™ì¼í•œ ê²½ë¡œì™€ ì¼ì¹˜í•˜ë¯€ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:

- `routes/api/users.index.ts`
- `routes/api.users.ts`
- `routes/api.users.index.ts`.

â— ë˜ í•˜ë‚˜ ê¸°ì–µí•  ì ì€, API Routesì—ëŠ” pathless/layout ë¼ìš°íŠ¸ë‚˜ ë³‘ë ¬ ë¼ìš°íŠ¸ì˜ ê°œë…ì´ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼:

- `routes/api/_layout/users.ts`ëŠ” `/api/_layout/users`ë¡œ í•´ì„ë˜ë©° **NOT** `/api/users`ë¡œ í•´ì„ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

## Nested Directories vs File-names

ìœ„ ì˜ˆì œì—ì„œ ë³´ë“¯ì´ íŒŒì¼ ëª…ëª… ê·œì¹™ì€ ìœ ì—°í•˜ë©° ë””ë ‰í† ë¦¬ì™€ íŒŒì¼ ì´ë¦„ì„ í˜¼í•©í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì í•©í•œ ë°©ì‹ìœ¼ë¡œ API Routesë¥¼ êµ¬ì„±í•  ìˆ˜ ìžˆë„ë¡ ì˜ë„ì ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ìžì„¸í•œ ë‚´ìš©ì€ [TanStack Router File-based Routing Guide](../guide/file-based-routing.md#s-or-s)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

## Setting up the entry handler

TanStack Start í”„ë¡œì íŠ¸ëŠ” API ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì ì ˆí•œ API ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ë¼ìš°íŒ…í•˜ê¸° ìœ„í•´ ì—”íŠ¸ë¦¬ í•¸ë“¤ëŸ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ í”„ë¡œì íŠ¸ì— `app/api.ts` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤:

```ts
// app/api.ts
import {
  createStartAPIHandler,
  defaultAPIFileRouteHandler,
} from "@tanstack/start/api";

export default createStartAPIHandler(defaultAPIFileRouteHandler);
```

ì´ íŒŒì¼ì€ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ì ì ˆí•œ API ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ë¼ìš°íŒ…í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” API í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. `defaultAPIFileRouteHandler`ëŠ” ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì— ë”°ë¼ ì ì ˆí•œ API ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ìžë™ìœ¼ë¡œ ë¡œë“œí•˜ê³  ì‹¤í–‰í•˜ëŠ” í—¬í¼ í•¨ìˆ˜ìž…ë‹ˆë‹¤.

## Defining an API Route

API RoutesëŠ” `createAPIFileRoute` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ APIRoute ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‚´ë³´ëƒ…ë‹ˆë‹¤. TanStack Routerì˜ ë‹¤ë¥¸ íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŠ¸ì™€ ìœ ì‚¬í•˜ê²Œ, ì´ í•¨ìˆ˜ì˜ ì²« ë²ˆì§¸ ì¸ìˆ˜ëŠ” ë¼ìš°íŠ¸ ê²½ë¡œìž…ë‹ˆë‹¤. ë°˜í™˜ëœ í•¨ìˆ˜ëŠ” ê° HTTP ë©”ì„œë“œì— ëŒ€í•œ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì •ì˜í•˜ëŠ” ê°ì²´ì™€ í•¨ê»˜ ë‹¤ì‹œ í˜¸ì¶œë©ë‹ˆë‹¤.

```ts
// routes/api/hello.ts
import { createAPIFileRoute } from "@tanstack/start/api";

export const APIRoute = createAPIFileRoute("/hello")({
  GET: async ({ request }) => {
    return new Response("Hello, World! from " + request.url);
  },
});
```

ê° HTTP ë©”ì„œë“œ í•¸ë“¤ëŸ¬ëŠ” ë‹¤ìŒ ì†ì„±ì„ ê°€ì§„ ê°ì²´ë¥¼ ë°›ìŠµë‹ˆë‹¤:

- `request`: ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ ê°ì²´. [MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/API/Request)ì—ì„œ `Request` ê°ì²´ì— ëŒ€í•´ ë” ì•Œì•„ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- `params`: ë¼ìš°íŠ¸ì˜ ë™ì  ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” ê°ì²´. ì˜ˆë¥¼ ë“¤ì–´, ê²½ë¡œê°€ `/users/$id`ì´ê³  ìš”ì²­ì´ `/users/123`ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ê²½ìš°, `params`ëŠ” `{ id: '123' }`ìž…ë‹ˆë‹¤.

## Dynamic Path Params

API RoutesëŠ” `$` ë’¤ì— ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì´ ì˜¤ëŠ” ë™ì  ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

```ts
// routes/api/users/$id.ts
import { createAPIFileRoute } from "@tanstack/start/api";

export const APIRoute = createAPIFileRoute("/users/$id")({
  GET: async ({ params }) => {
    const { id } = params;
    return new Response(`User ID: ${id}`);
  },
});
```

## Wildcard/Splat Param

ê²½ë¡œ ëì— `$` ë’¤ì— ì•„ë¬´ê²ƒë„ ì—†ëŠ” ì™€ì¼ë“œì¹´ë“œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤.

```ts
// routes/api/file/$.ts
import { createAPIFileRoute } from "@tanstack/start/api";

export const APIRoute = createAPIFileRoute("/file/$")({
  GET: async ({ params }) => {
    const { _splat } = params;
    return new Response(`File: ${_splat}`);
  },
});
```

## Handling requests with a body

POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ë ¤ë©´ ë¼ìš°íŠ¸ ê°ì²´ì— `POST` í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

```ts
// routes/api/hello.ts
import { createAPIFileRoute } from "@tanstack/start/api";

export const APIRoute = createAPIFileRoute("/hello")({
  POST: async ({ request }) => {
    const body = await request.json();
    return new Response(`Hello, ${body.name}!`);
  },
});
```

## Responding with JSON

`Response` ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ JSONì„ ë°˜í™˜í•˜ëŠ” ì¼ë°˜ì ì¸ íŒ¨í„´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```ts
// routes/api/hello.ts
import { createAPIFileRoute } from "@tanstack/start/api";

export const APIRoute = createAPIFileRoute("/hello")({
  GET: async ({ request }) => {
    return new Response(JSON.stringify({ message: "Hello, World!" }), {
      headers: {
        "Content-Type": "application/json",
      },
    });
  },
});
```

## Using the `json` helper function

`json` í—¬í¼ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ `Content-Type` í—¤ë”ë¥¼ ìžë™ìœ¼ë¡œ ì„¤ì •í•˜ê³  JSON ê°ì²´ë¥¼ ì§ë ¬í™”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

```ts
// routes/api/hello.ts
import { json } from "@tanstack/start";
import { createAPIFileRoute } from "@tanstack/start/api";

export const APIRoute = createAPIFileRoute("/hello")({
  GET: async ({ request }) => {
    return json({ message: "Hello, World!" });
  },
});
```

## Responding with a status code

ì‘ë‹µì˜ ìƒíƒœ ì½”ë“œëŠ” ë‹¤ìŒ ë°©ë²•ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

- `Response` ìƒì„±ìžì˜ ë‘ ë²ˆì§¸ ì¸ìˆ˜ë¡œ ìƒíƒœ ì½”ë“œë¥¼ ì „ë‹¬

  ```ts
  // routes/api/hello.ts
  import { json } from "@tanstack/start";
  import { createAPIFileRoute } from "@tanstack/start/api";

  export const APIRoute = createAPIFileRoute("/users/$id")({
    GET: async ({ request, params }) => {
      const user = await findUser(params.id);
      if (!user) {
        return new Response("User not found", {
          status: 404,
        });
      }
      return json(user);
    },
  });
  ```

- `vinxi/http`ì˜ `setResponseStatus` í—¬í¼ í•¨ìˆ˜ë¥¼ ì‚¬ìš©

  ```ts
  // routes/api/hello.ts
  import { json } from "@tanstack/start";
  import { createAPIFileRoute } from "@tanstack/start/api";
  import { setResponseStatus } from "vinxi/http";

  export const APIRoute = createAPIFileRoute("/users/$id")({
    GET: async ({ request, params }) => {
      const user = await findUser(params.id);
      if (!user) {
        setResponseStatus(404);
        return new Response("User not found");
      }
      return json(user);
    },
  });
  ```

ì´ ì˜ˆì œì—ì„œëŠ” ì‚¬ìš©ìžê°€ ì—†ì„ ê²½ìš° `404` ìƒíƒœ ì½”ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ ë°©ë²•ìœ¼ë¡œ ëª¨ë“  ìœ íš¨í•œ HTTP ìƒíƒœ ì½”ë“œë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## Setting headers in the response

ë•Œë¡œëŠ” ì‘ë‹µì— í—¤ë”ë¥¼ ì„¤ì •í•´ì•¼ í•  ë•Œê°€ ìžˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë‹¤ìŒ ë°©ë²•ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

- `Response` ìƒì„±ìžì˜ ë‘ ë²ˆì§¸ ì¸ìˆ˜ë¡œ ê°ì²´ë¥¼ ì „ë‹¬í•˜ì—¬ ì„¤ì •

  ```ts
  // routes/api/hello.ts
  import { createAPIFileRoute } from "@tanstack/start/api";

  export const APIRoute = createAPIFileRoute("/hello")({
    GET: async ({ request }) => {
      return new Response("Hello, World!", {
        headers: {
          "Content-Type": "text/plain",
        },
      });
    },
  });

  // /api/helloë¡œ ë°©ë¬¸í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤:
  // Hello, World!
  ```

- ë˜ëŠ” `vinxi/http`ì˜ `setHeaders` í—¬í¼ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ì •

  ```ts
  // routes/api/hello.ts
  import { createAPIFileRoute } from "@tanstack/start/api";
  import { setHeaders } from "vinxi/http";

  export const APIRoute = createAPIFileRoute("/hello")({
    GET: async ({ request }) => {
      setHeaders({
        "Content-Type": "text/plain",
      });
      return new Response("Hello, World!");
    },
  });
  ```
