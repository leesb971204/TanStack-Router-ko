---
title: Search Params
---

## Search Params

TanStack Queryκ°€ React μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ„λ²„ μƒνƒλ¥Ό μ‰½κ² μ²λ¦¬ν•  μ μλ„λ΅ λ§λ“  κ²ƒμ²λΌ, TanStack Routerλ” μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ URL κ²€μƒ‰ νλΌλ―Έν„°μ κΈ°λ¥μ„ ν™μ©ν•  μ μλ„λ΅ λ•μµλ‹λ‹¤.

## Why not just use `URLSearchParams`?

"ν”λ«νΌμ„ μ‚¬μ©ν•λΌ"λ” λ§μ„ μμ£Ό λ“¤μΌμ…¨κ² μ§€λ§, λ€λ¶€λ¶„ λ™μν•λ©΄μ„λ„ κ³ κΈ‰ μ‚¬μ© μ‚¬λ΅€μ—μ„λ” ν”λ«νΌμ ν•κ³„λ¥Ό μΈμ •ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤κ³  μƒκ°ν•©λ‹λ‹¤. `URLSearchParams`κ°€ λ°”λ΅ κ·Έλ° ν•κ³„λ¥Ό λ³΄μ—¬μ£Όλ” μλΌκ³  λ―Ώμµλ‹λ‹¤.

μ „ν†µμ μΈ κ²€μƒ‰ νλΌλ―Έν„° APIλ” λ³΄ν†µ λ‹¤μκ³Ό κ°™μ€ κ°€μ •μ„ ν•©λ‹λ‹¤:

- κ²€μƒ‰ νλΌλ―Έν„°λ” ν•­μƒ λ¬Έμμ—΄μ΄λ‹¤.
- κ²€μƒ‰ νλΌλ―Έν„°λ” _λ€μ²΄λ΅_ ν”λ«ν•λ‹¤.
- `URLSearchParams`λ¥Ό μ‚¬μ©ν• μ§λ ¬ν™” λ° μ—­μ§λ ¬ν™”κ°€ μ¶©λ¶„ν•λ‹¤. (μ¤ν¬μΌλ¬: μ¶©λ¶„ν•μ§€ μ•μµλ‹λ‹¤.)
- κ²€μƒ‰ νλΌλ―Έν„° μμ •μ€ URLμ κ²½λ΅λ…κ³Ό λ°€μ ‘ν•κ² μ—°κ²°λμ–΄ μμΌλ©°, κ²½λ΅λ…μ΄ λ³€κ²½λμ§€ μ•μ•„λ„ ν•¨κ» μ—…λ°μ΄νΈλμ–΄μ•Ό ν•λ‹¤.

κ·Έλ¬λ‚ μ‹¤μ λ΅λ” μ΄λ¬ν• κ°€μ •κ³Όλ” λ‹¤λ¦…λ‹λ‹¤.

- κ²€μƒ‰ νλΌλ―Έν„°λ” μ• ν”λ¦¬μΌ€μ΄μ… μƒνƒλ¥Ό λ‚νƒ€λ‚΄λ―€λ΅, λ‹¤λ¥Έ μƒνƒ κ΄€λ¦¬ λ„κµ¬μ™€ λ™μΌν• κ°λ°μ κ²½ν—(DX)μ„ κΈ°λ€ν•κ² λ©λ‹λ‹¤. μ΄λ” μ›μ‹ κ°’ μ ν•μ„ κµ¬λ¶„ν•κ³  μ¤‘μ²© λ°°μ—΄ λ° κ°μ²΄μ™€ κ°™μ€ λ³µμ΅ν• λ°μ΄ν„° κµ¬μ΅°λ¥Ό ν¨μ¨μ μΌλ΅ μ €μ¥ν•κ³  μ΅°μ‘ν•  μ μλ” κΈ°λ¥μ„ ν¬ν•¨ν•©λ‹λ‹¤.
- μƒνƒλ¥Ό μ§λ ¬ν™”ν•κ³  μ—­μ§λ ¬ν™”ν•λ” λ°©λ²•μ€ μ—¬λ¬ κ°€μ§€κ°€ μμΌλ©°, κ°κ° λ‹¤λ¥Έ νΈλ μ΄λ“μ¤ν”„κ°€ μμµλ‹λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ…μ— μ ν•©ν• λ°©λ²•μ„ μ„ νƒν•κ±°λ‚ μµμ†ν• `URLSearchParams`λ³΄λ‹¤ λ‚μ€ κΈ°λ³Έκ°’μ„ μ„ νƒν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤.
- λ¶λ³€μ„±κ³Ό κµ¬μ΅°μ  κ³µμ . URL κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό λ¬Έμμ—΄ν™”ν•κ±°λ‚ νμ‹±ν•  λ•λ§λ‹¤ μ°Έμ΅° λ¬΄κ²°μ„±κ³Ό κ°μ²΄ λ™μΌμ„±μ΄ μ†μ‹¤λ©λ‹λ‹¤. μ΄λ” Reactμ™€ κ°™μ€ ν”„λ μ„μ›ν¬μ—μ„ μκΈ°μΉ μ•μ€ μ„±λ¥ λ¬Έμ λ¥Ό μ•ΌκΈ°ν•  μ μμµλ‹λ‹¤.
- κ²€μƒ‰ νλΌλ―Έν„°λ” URL κ²½λ΅λ…κ³Ό λ…λ¦½μ μΌλ΅ μμ£Ό λ³€κ²½λ©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, νμ΄μ§€λ„¤μ΄μ…λ λ©λ΅μ—μ„ νμ΄μ§€ λ²νΈλ¥Ό λ³€κ²½ν•  λ• URL κ²½λ΅λ…μ€ λ³€κ²½λμ§€ μ•μ„ μ μμµλ‹λ‹¤.

## Search Params, the "OG" State Manager

κ²€μƒ‰ νλΌλ―Έν„°λ” URLμ—μ„ `?page=3` λλ” `?filter-name=tanner`μ™€ κ°™μ΄ ν‘μ‹λ©λ‹λ‹¤. μ΄λ” URL λ‚΄μ—μ„ **κΈ€λ΅λ² μƒνƒμ ν• ν•νƒ**λΌλ” μ μ„ λ¶€μΈν•  μ μ—†μµλ‹λ‹¤. URLμ— νΉμ • μƒνƒλ¥Ό μ €μ¥ν•λ” κ²ƒμ€ μ μ©ν•©λ‹λ‹¤. λ‹¤μκ³Ό κ°™μ€ μ΄μ  λ•λ¬Έμ…λ‹λ‹¤:

- μ‚¬μ©μλ“¤μ€ λ‹¤μμ„ ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤:
  - Cmd/Ctrl + ν΄λ¦­μΌλ΅ λ§ν¬λ¥Ό μƒ νƒ­μ—μ„ μ—΄κ³  κΈ°λ€ν• μƒνƒλ¥Ό μ‹ λΆ°ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤.
  - μ• ν”λ¦¬μΌ€μ΄μ…μ λ§ν¬λ¥Ό λ¶λ§ν¬ν•κ±°λ‚ κ³µμ ν–μ„ λ•, λ³µμ‚¬ν• λ‹Ήμ‹μ μƒνƒκ°€ μ μ§€λμ–΄μ•Ό ν•©λ‹λ‹¤.
  - μ• ν”λ¦¬μΌ€μ΄μ…μ„ μƒλ΅κ³ μΉ¨ν•κ±°λ‚ νμ΄μ§€ κ°„ μ΄λ™ μ‹ μƒνƒλ¥Ό μƒμ§€ μ•μ•„μ•Ό ν•©λ‹λ‹¤.
- κ°λ°μλ“¤μ€ λ‹¤μμ„ μ‰½κ² ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤:
  - URLμ—μ„ μƒνƒλ¥Ό μ¶”κ°€, μ κ±° λλ” μμ •ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤.
  - μ• ν”λ¦¬μΌ€μ΄μ…μ— μ•μ „ν• ν•μ‹κ³Ό νƒ€μ…μΌλ΅ URLμ—μ„ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤.
  - μ§λ ¬ν™” ν•μ‹μ„ κ±±μ •ν•μ§€ μ•κ³  κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ½κ³  μ“Έ μ μμ–΄μ•Ό ν•©λ‹λ‹¤.

## JSON-first Search Params

μ„ λ©ν‘λ¥Ό λ‹¬μ„±ν•κΈ° μ„ν•΄ TanStack Routerμ—λ” URL κ²€μƒ‰ λ¬Έμμ—΄μ„ κµ¬μ΅°ν™”λ JSONμΌλ΅ μλ™ λ³€ν™ν•λ” κ°•λ ¥ν• κ²€μƒ‰ νλΌλ―Έν„° νμ„κ°€ λ‚΄μ¥λμ–΄ μμµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ JSON-μ§λ ¬ν™” κ°€λ¥ν• λ¨λ“  λ°μ΄ν„° κµ¬μ΅°λ¥Ό κ²€μƒ‰ νλΌλ―Έν„°μ— μ €μ¥ν•  μ μμΌλ©°, JSONμΌλ΅ νμ‹± λ° μ§λ ¬ν™”λ©λ‹λ‹¤. μ΄λ” λ°°μ—΄ λ° μ¤‘μ²© λ°μ΄ν„°μ— λ€ν• μ§€μ›μ΄ μ ν•μ μΈ `URLSearchParams`λ³΄λ‹¤ ν° κ°μ„ μ μ…λ‹λ‹¤.

μλ¥Ό λ“¤μ–΄, λ‹¤μ κ²½λ΅λ΅ μ΄λ™ν•λ©΄:

```tsx
const link = (
  <Link
    to="/shop"
    search={{
      pageIndex: 3,
      includeCategories: ["electronics", "gifts"],
      sortBy: "price",
      desc: true,
    }}
  />
);
```

λ‹¤μκ³Ό κ°™μ€ URLμ΄ μƒμ„±λ©λ‹λ‹¤:

```
/shop?pageIndex=3&includeCategories=%5B%22electronics%22%2C%22gifts%22%5D&sortBy=price&desc=true
```

μ΄ URLμ΄ νμ‹±λλ©΄, κ²€μƒ‰ νλΌλ―Έν„°λ” λ‹¤μ JSONμΌλ΅ μ •ν™•ν λ³€ν™λ©λ‹λ‹¤:

```json
{
  "pageIndex": 3,
  "includeCategories": ["electronics", "gifts"],
  "sortBy": "price",
  "desc": true
}
```

μ—¬κΈ°μ—μ„ λ‡ κ°€μ§€ μ¤‘μ”ν• μ μ„ ν™•μΈν•  μ μμµλ‹λ‹¤:

- κ²€μƒ‰ νλΌλ―Έν„°μ μ²« λ²μ§Έ μμ¤€μ€ `URLSearchParams`μ™€ λ§μ°¬κ°€μ§€λ΅ ν”λ«ν•κ³  λ¬Έμμ—΄ κΈ°λ°μ…λ‹λ‹¤.
- λ¬Έμμ—΄μ΄ μ•„λ‹ μ²« λ²μ§Έ μμ¤€ κ°’λ“¤μ€ μ‹¤μ  μ«μ λ° λ¶λ¦¬μ–Έ κ°’μΌλ΅ μ •ν™•ν λ³΄μ΅΄λ©λ‹λ‹¤.
- μ¤‘μ²©λ λ°μ΄ν„° κµ¬μ΅°λ” URL μ•μ „ JSON λ¬Έμμ—΄λ΅ μλ™ λ³€ν™λ©λ‹λ‹¤.

> π§  μΌλ°μ μΌλ΅ λ‹¤λ¥Έ λ„κµ¬λ“¤μ€ κ²€μƒ‰ νλΌλ―Έν„°κ°€ ν•­μƒ ν”λ«ν•κ³  λ¬Έμμ—΄ κΈ°λ°μ΄λΌκ³  κ°€μ •ν•κΈ° λ•λ¬Έμ—, TanStack Routerλ” μ²« λ²μ§Έ μμ¤€μ—μ„ `URLSearchParams`μ™€ νΈν™λλ„λ΅ μ μ§€ν•©λ‹λ‹¤. λ”°λΌμ„ TanStack Routerκ°€ JSONμΌλ΅ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ΄€λ¦¬ν•λ”λΌλ„ λ‹¤λ¥Έ λ„κµ¬λ“¤μ€ μ—¬μ „ν URLμ—μ„ μ²« λ²μ§Έ μμ¤€μ νλΌλ―Έν„°λ¥Ό μ •μƒμ μΌλ΅ μ½κ³  μ“Έ μ μμµλ‹λ‹¤.

## Validating and Typing Search Params

TanStack Routerλ” κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ‹ λΆ°ν•  μ μλ” JSONμΌλ΅ νμ‹±ν•  μ μμ§€λ§, μ΄λ“¤μ€ κ²°κµ­ **μ‚¬μ©μ μ…λ ¥μ μ›μ‹ ν…μ¤νΈ**μ—μ„ λΉ„λ΅―λ©λ‹λ‹¤. λ”°λΌμ„ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•κΈ° μ „μ— μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ‹ λΆ°ν•κ³  μμ΅΄ν•  μ μλ” ν•μ‹μΌλ΅ κ²€μ¦ν•΄μ•Ό ν•©λ‹λ‹¤.

### Enter Validation + TypeScript!

TanStack Routerλ” κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν•κ³  νƒ€μ…ν™”ν•  μ μλ” νΈλ¦¬ν• APIλ¥Ό μ κ³µν•©λ‹λ‹¤. μ΄λ” `Route`μ `validateSearch` μµμ…μΌλ΅ μ‹μ‘λ©λ‹λ‹¤:

```tsx
// /routes/shop.products.tsx

type ProductSearchSortOptions = "newest" | "oldest" | "price";

type ProductSearch = {
  page: number;
  filter: string;
  sort: ProductSearchSortOptions;
};

export const Route = createFileRoute("/shop/products")({
  validateSearch: (search: Record<string, unknown>): ProductSearch => {
    // validate and parse the search params into a typed state
    return {
      page: Number(search?.page ?? 1),
      filter: (search.filter as string) || "",
      sort: (search.sort as ProductSearchSortOptions) || "newest",
    };
  },
});
```

μ„ μμ μ—μ„λ” `allProductsRoute`μ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν• ν›„, νƒ€μ…ν™”λ `ProductSearch` κ°μ²΄λ¥Ό λ°ν™ν•©λ‹λ‹¤. μ΄ νƒ€μ…ν™”λ κ°μ²΄λ” ν•΄λ‹Ή κ²½λ΅μ λ‹¤λ¥Έ μµμ…λΏλ§ μ•„λ‹λΌ **λ¨λ“  ν•μ„ κ²½λ΅μ—μ„λ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤!**

### Validating Search Params

`validateSearch` μµμ…μ€ JSONμΌλ΅ νμ‹±λ(ν•μ§€λ§ κ²€μ¦λμ§€ μ•μ€) κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό `Record<string, unknown>`λ΅ μ „λ‹¬λ°›μ•„ μ›ν•λ” νƒ€μ…μ κ°μ²΄λ¥Ό λ°ν™ν•λ” ν•¨μμ…λ‹λ‹¤. μΌλ°μ μΌλ΅, μλ»λ ν•μ‹μ΄κ±°λ‚ μκΈ°μΉ μ•μ€ κ²€μƒ‰ νλΌλ―Έν„°μ— λ€ν•΄ ν•©λ¦¬μ μΈ κΈ°λ³Έκ°’μ„ μ κ³µν•μ—¬ μ‚¬μ©μ κ²½ν—μ΄ μ¤‘λ‹¨λμ§€ μ•λ„λ΅ ν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.

λ‹¤μμ€ μμ‹μ…λ‹λ‹¤:

```tsx
// /routes/shop.products.tsx

type ProductSearchSortOptions = "newest" | "oldest" | "price";

type ProductSearch = {
  page: number;
  filter: string;
  sort: ProductSearchSortOptions;
};

export const Route = createFileRoute("/shop/products")({
  validateSearch: (search: Record<string, unknown>): ProductSearch => {
    // κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν•κ³  νƒ€μ…ν™”λ μƒνƒλ΅ λ³€ν™ν•©λ‹λ‹¤.
    return {
      page: Number(search?.page ?? 1),
      filter: (search.filter as string) || "",
      sort: (search.sort as ProductSearchSortOptions) || "newest",
    };
  },
});
```

λ‹¤μμ€ [Zod](https://zod.dev/) λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν•κ³  λ™μ‹μ— νƒ€μ…μ„ μ§€μ •ν•λ” μμ μ…λ‹λ‹¤(λ‹¤λ¥Έ κ²€μ¦ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•΄λ„ κ΄μ°®μµλ‹λ‹¤):

```tsx
// /routes/shop.products.tsx

import { z } from "zod";

const productSearchSchema = z.object({
  page: z.number().catch(1),
  filter: z.string().catch(""),
  sort: z.enum(["newest", "oldest", "price"]).catch("newest"),
});

type ProductSearch = z.infer<typeof productSearchSchema>;

export const Route = createFileRoute("/shop/products")({
  validateSearch: (search) => productSearchSchema.parse(search),
});
```

`validateSearch`κ°€ `parse` μ†μ„±μ„ κ°€μ§„ κ°μ²΄λ„ ν—μ©ν•κΈ° λ•λ¬Έμ— λ‹¤μκ³Ό κ°™μ΄ μ¶•μ•½ν•  μ μμµλ‹λ‹¤:

```tsx
validateSearch: productSearchSchema;
```

μ„ μμ μ—μ„, μ°λ¦¬λ” Zodμ `.catch()` μμ‹μ„ μ‚¬μ©ν•μ—¬ μ‚¬μ©μμ—κ² μ¤λ¥λ¥Ό ν‘μ‹ν•λ” λ€μ‹  μλ»λ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ²λ¦¬ν–μµλ‹λ‹¤. μ΄λ” μλ»λ κ²€μƒ‰ νλΌλ―Έν„°λ΅ μΈν•΄ μ‚¬μ©μ κ²½ν—μ΄ μ¤‘λ‹¨λμ§€ μ•λ„λ΅ ν•κΈ° μ„ν• κ²ƒμ…λ‹λ‹¤. κ·Έλ¬λ‚ λ•λ΅λ” **μ¤λ¥ λ©”μ‹μ§€λ¥Ό ν‘μ‹ν•κ³  μ‹¶μ„ λ•**κ°€ μμ„ μ μμµλ‹λ‹¤. μ΄ κ²½μ° `.catch()` λ€μ‹  `.default()`λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

μ΄ λ°©μ‹μ΄ μ‘λ™ν•λ” μ΄μ λ” `validateSearch` ν•¨μκ°€ μ¤λ¥λ¥Ό λμ§€κΈ° λ•λ¬Έμ…λ‹λ‹¤. μ¤λ¥κ°€ λ°μƒν•λ©΄ ν•΄λ‹Ή κ²½λ΅μ `onError` μµμ…μ΄ μ‹¤ν–‰λκ³ (`error.routerCode`λ” `VALIDATE_SEARCH`λ΅ μ„¤μ •λ¨), κ²½λ΅μ `component` λ€μ‹  `errorComponent`κ°€ λ λ”λ§λ©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ κ²€μƒ‰ νλΌλ―Έν„° μ¤λ¥λ¥Ό μ›ν•λ” λ°©μ‹μΌλ΅ μ²λ¦¬ν•  μ μμµλ‹λ‹¤.

#### Adapters

[Zod](https://zod.dev/)μ™€ κ°™μ€ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό κ²€μ¦ν•  λ•, κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό URLμ— μ»¤λ°‹ν•κΈ° μ „μ— `transform`μ„ μ‚¬μ©ν•κ³  μ‹¶μ„ μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, Zodμ μΌλ°μ μΈ `transform`μ€ `default`μ…λ‹λ‹¤.

```tsx
import { createFileRoute } from "@tanstack/react-router";
import { z } from "zod";

const productSearchSchema = z.object({
  page: z.number().default(1),
  filter: z.string().default(""),
  sort: z.enum(["newest", "oldest", "price"]).default("newest"),
});

export const Route = createFileRoute("/shop/products/")({
  validateSearch: productSearchSchema,
});
```

μ„ μ½”λ“μ—μ„ μ΄ κ²½λ΅λ΅ νƒμƒ‰ν•  λ• `search`κ°€ ν•„μμ μ΄λΌλ” μ μ΄ λ†€λΌμΈ μ μμµλ‹λ‹¤. λ‹¤μκ³Ό κ°™μ€ `Link`λ” `search`κ°€ λ„λ½λμ—κΈ° λ•λ¬Έμ— νƒ€μ… μ¤λ¥κ°€ λ°μƒν•©λ‹λ‹¤.

```tsx
<Link to="/shop/products" />
```

κ²€μ¦ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•  λ•, μ¬λ°”λ¥Έ `input` λ° `output` νƒ€μ…μ„ μ¶”λ΅ ν•λ” μ–΄λ‘ν„°λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ„ κ¶μ¥ν•©λ‹λ‹¤.

### Zod

[Zod](https://zod.dev/)λ¥Ό μ„ν• μ–΄λ‘ν„°κ°€ μ κ³µλλ©°, μ΄λ¥Ό ν†µν•΄ μ¬λ°”λ¥Έ `input` νƒ€μ…κ³Ό `output` νƒ€μ…μ„ μ—°κ²°ν•  μ μμµλ‹λ‹¤.

```tsx
import { createFileRoute } from "@tanstack/react-router";
import { zodValidator } from "@tanstack/zod-adapter";
import { z } from "zod";

const productSearchSchema = z.object({
  page: z.number().default(1),
  filter: z.string().default(""),
  sort: z.enum(["newest", "oldest", "price"]).default("newest"),
});

export const Route = createFileRoute("/shop/products/")({
  validateSearch: zodValidator(productSearchSchema),
});
```

μ—¬κΈ°μ—μ„ μ¤‘μ”ν• μ μ€ `Link` μ‚¬μ© μ‹ λ” μ΄μƒ `search` νλΌλ―Έν„°κ°€ ν•„μ”ν•μ§€ μ•λ‹¤λ” κ²ƒμ…λ‹λ‹¤.

```tsx
<Link to="/shop/products" />
```

κ·Έλ¬λ‚ μ—¬κΈ°μ„ `.catch`λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ νƒ€μ…μ„ λ®μ–΄μ“°λ©°, `page`, `filter`, `sort`λ¥Ό `unknown`μΌλ΅ λ§λ“¤μ–΄ νƒ€μ… μ†μ‹¤μ„ μ•ΌκΈ°ν•©λ‹λ‹¤. μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ κ²€μ¦ μ‹¤ν¨ μ‹ `fallback` κ°’μ„ μ κ³µν•λ©΄μ„ νƒ€μ…μ„ μ μ§€ν•λ” `fallback` μ λ„λ¦­ ν•¨μλ¥Ό μ κ³µν•©λ‹λ‹¤.

```tsx
import { createFileRoute } from "@tanstack/react-router";
import { fallback, zodValidator } from "@tanstack/zod-adapter";
import { z } from "zod";

const productSearchSchema = z.object({
  page: fallback(z.number(), 1).default(1),
  filter: fallback(z.string(), "").default(""),
  sort: fallback(z.enum(["newest", "oldest", "price"]), "newest").default(
    "newest"
  ),
});

export const Route = createFileRoute("/shop/products/")({
  validateSearch: zodValidator(productSearchSchema),
});
```

λ”°λΌμ„ μ΄ κ²½λ΅λ΅ νƒμƒ‰ν•  λ•, `search`λ” μ„ νƒ μ‚¬ν•­μ΄ λλ©° μ¬λ°”λ¥Έ νƒ€μ…μ„ μ μ§€ν•©λ‹λ‹¤.
κ¶μ¥λμ§€λ” μ•μ§€λ§, `output` νƒ€μ…μ΄ `input` νƒ€μ…λ³΄λ‹¤ λ” μ •ν™•ν• κ²½μ° `input`κ³Ό `output` νƒ€μ…μ„ κµ¬μ„±ν•  μλ„ μμµλ‹λ‹¤.

```tsx
const productSearchSchema = z.object({
  page: fallback(z.number(), 1).default(1),
  filter: fallback(z.string(), "").default(""),
  sort: fallback(z.enum(["newest", "oldest", "price"]), "newest").default(
    "newest"
  ),
});

export const Route = createFileRoute("/shop/products/")({
  validateSearch: zodValidator({
    schema: productSearchSchema,
    input: "output",
    output: "input",
  }),
});
```

μ΄ λ°©μ‹μ€ νƒμƒ‰ μ‹ μ‚¬μ©ν•  νƒ€μ…κ³Ό κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ½μ„ λ• μ‚¬μ©ν•  νƒ€μ…μ„ μ μ—°ν•κ² κµ¬μ„±ν•  μ μλ„λ΅ μ κ³µν•©λ‹λ‹¤.

### Valibot

> [!WARNING]
> Routerλ” Valibot 1.0 ν¨ν‚¤μ§€κ°€ μ„¤μΉλμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤.

[Valibot](https://valibot.dev/)μ„ μ‚¬μ©ν•  λ•, κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό νƒμƒ‰ λ° μ½κΈ°μ— μ ν•©ν• μ¬λ°”λ¥Έ `input`κ³Ό `output` νƒ€μ…μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ λ³„λ„μ μ–΄λ‘ν„°κ°€ ν•„μ”ν•μ§€ μ•μµλ‹λ‹¤. μ΄λ” `valibot`μ΄ [Standard Schema](https://github.com/standard-schema/standard-schema)λ¥Ό κµ¬ν„ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

```tsx
import { createFileRoute } from "@tanstack/react-router";
import * as v from "valibot";

const productSearchSchema = v.object({
  page: v.optional(v.fallback(v.number(), 1), 1),
  filter: v.optional(v.fallback(v.string(), ""), ""),
  sort: v.optional(
    v.fallback(v.picklist(["newest", "oldest", "price"]), "newest"),
    "newest"
  ),
});

export const Route = createFileRoute("/shop/products/")({
  validateSearch: productSearchSchema,
});
```

### Arktype

> [!WARNING]
> Routerλ” Arktype 2.0-rc ν¨ν‚¤μ§€κ°€ μ„¤μΉλμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤.

[ArkType](https://arktype.io/)μ„ μ‚¬μ©ν•  λ•, κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό νƒμƒ‰ λ° μ½κΈ°μ— μ ν•©ν• μ¬λ°”λ¥Έ `input`κ³Ό `output` νƒ€μ…μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ λ³„λ„μ μ–΄λ‘ν„°κ°€ ν•„μ”ν•μ§€ μ•μµλ‹λ‹¤. μ΄λ” [ArkType](https://arktype.io/)μ΄ [Standard Schema](https://github.com/standard-schema/standard-schema)λ¥Ό κµ¬ν„ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

```tsx
import { createFileRoute } from "@tanstack/react-router";
import { type } from "arktype";

const productSearchSchema = type({
  page: "number = 1",
  filter: 'string = ""',
  sort: '"newest" | "oldest" | "price" = "newest"',
});

export const Route = createFileRoute("/shop/products/")({
  validateSearch: productSearchSchema,
});
```

## Reading Search Params

κ²€μƒ‰ νλΌλ―Έν„°κ°€ κ²€μ¦λκ³  νƒ€μ…ν™”λ ν›„, μ΄λ¥Ό μ½κ³  μ“°λ” μ‘μ—…μ„ μ‹μ‘ν•  μ¤€λΉ„κ°€ μ™„λ£λ©λ‹λ‹¤. TanStack Routerμ—μ„λ” μ΄λ¥Ό μν–‰ν•λ” μ—¬λ¬ κ°€μ§€ λ°©λ²•μ΄ μμµλ‹λ‹¤.

### Using Search Params in Loaders

`loaderDeps` μµμ…μ„ μ‚¬μ©ν•μ—¬ λ΅λ”μ—μ„ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ½λ” λ°©λ²•μ— λ€ν• μμ„Έν• λ‚΄μ©μ€ [Search Params in Loaders](./data-loading.md#using-loaderdeps-to-access-search-params) μ„Ήμ…μ„ μ°Έμ΅°ν•μ„Έμ”.

### Search Params are inherited from Parent Routes

μƒμ„ κ²½λ΅μ κ²€μƒ‰ νλΌλ―Έν„°μ™€ νƒ€μ…μ€ κ²½λ΅ νΈλ¦¬λ¥Ό λ”°λΌ λ‚΄λ ¤κ°€λ©° λ³‘ν•©λλ―€λ΅, ν•μ„ κ²½λ΅μ—μ„λ„ μƒμ„ κ²½λ΅μ κ²€μƒ‰ νλΌλ―Έν„°μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤:

- `shop.products.tsx`

```tsx
const productSearchSchema = z.object({
  page: z.number().catch(1),
  filter: z.string().catch(""),
  sort: z.enum(["newest", "oldest", "price"]).catch("newest"),
});

type ProductSearch = z.infer<typeof productSearchSchema>;

export const Route = createFileRoute("/shop/products")({
  validateSearch: productSearchSchema,
});
```

- `shop.products.$productId.tsx`

```tsx
export const Route = createFileRoute("/shop/products/$productId")({
  beforeLoad: ({ search }) => {
    search;
    // ^? ProductSearch β…
  },
});
```

### Search Params in Components

`useSearch` ν›…μ„ ν†µν•΄ κ²½λ΅μ `component`μ—μ„ κ²€μ¦λ κ²€μƒ‰ νλΌλ―Έν„°μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤.

```tsx
// /routes/shop.products.tsx

export const Route = createFileRoute("/shop/products")({
  validateSearch: productSearchSchema,
});

const ProductList = () => {
  const { page, filter, sort } = Route.useSearch();

  return <div>...</div>;
};
```

> [!TIP]
> μ»΄ν¬λ„νΈκ°€ μ½”λ“ λ¶„ν• λμ–΄ μλ” κ²½μ°, [getRouteApi ν•¨μ](./code-splitting.md#manually-accessing-route-apis-in-other-files-with-the-getrouteapi-helper)λ¥Ό μ‚¬μ©ν•μ—¬ `Route` μ„¤μ •μ„ κ°€μ Έμ¤μ§€ μ•κ³ λ„ νƒ€μ…ν™”λ `useSearch()` ν›…μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤.

### Search Params outside of Route Components

`useSearch` ν›…μ„ μ‚¬μ©ν•μ—¬ μ• ν”λ¦¬μΌ€μ΄μ…μ μ–΄λ κ³³μ—μ„λ‚ κ²½λ΅μ κ²€μ¦λ κ²€μƒ‰ νλΌλ―Έν„°μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤. `from` ID λλ” κ²½λ΅λ¥Ό μ „λ‹¬ν•λ©΄ λ”μ± κ°•λ ¥ν• νƒ€μ… μ•μ •μ„±μ„ μ–»μ„ μ μμµλ‹λ‹¤:

```tsx
const allProductsRoute = createRoute({
  getParentRoute: () => shopRoute,
  path: "products",
  validateSearch: productSearchSchema,
});

// λ‹¤λ¥Έ κ³³μ—μ„...

const routeApi = getRouteApi("/shop/products");

const ProductList = () => {
  const routeSearch = routeApi.useSearch();

  // OR

  const { page, filter, sort } = useSearch({
    from: allProductsRoute.fullPath,
  });

  return <div>...</div>;
};
```

νΉμ€ `strict: false`λ¥Ό μ „λ‹¬ν•μ—¬ νƒ€μ… μ•μ „μ„±μ„ λ‚®μ¶”κ³  μ„ νƒμ μΈ `search` κ°μ²΄λ¥Ό μ–»μ„ μλ„ μμµλ‹λ‹¤:

```tsx
function ProductList() {
  const search = useSearch({
    strict: false,
  });
  // {
  //   page: number | undefined
  //   filter: string | undefined
  //   sort: 'newest' | 'oldest' | 'price' | undefined
  // }

  return <div>...</div>;
}
```

## Writing Search Params

μ΄μ  κ²½λ΅μ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ½λ” λ°©λ²•μ„ λ°°μ› μΌλ‹, μ΄λ¥Ό μμ •ν•κ³  μ—…λ°μ΄νΈν•λ” κΈ°λ³Έ APIμ— λ€ν•΄ μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤.

### `<Link search />`

κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ—…λ°μ΄νΈν•λ” κ°€μ¥ μΆ‹μ€ λ°©λ²•μ€ `<Link />` μ»΄ν¬λ„νΈμ `search` μ†μ„±μ„ μ‚¬μ©ν•λ” κ²ƒμ…λ‹λ‹¤.

ν„μ¬ νμ΄μ§€μ κ²€μƒ‰μ„ μ—…λ°μ΄νΈν•κ³  `from` μ†μ„±μ΄ μ§€μ •λ κ²½μ° `to` μ†μ„±μ„ μƒλµν•  μ μμµλ‹λ‹¤.  
μμ‹λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

```tsx
// /routes/shop.products.tsx
export const Route = createFileRoute("/shop/products")({
  validateSearch: productSearchSchema,
});

const ProductList = () => {
  return (
    <div>
      <Link
        from={allProductsRoute.fullPath}
        search={(prev) => ({ page: prev.page + 1 })}
      >
        Next Page
      </Link>
    </div>
  );
};
```

μ—¬λ¬ κ²½λ΅μ—μ„ λ λ”λ§λλ” μΌλ°μ μΈ μ»΄ν¬λ„νΈμ—μ„ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ—…λ°μ΄νΈν•λ ¤λ©΄ `from`μ„ μ§€μ •ν•κΈ° μ–΄λ ¤μΈ μ μμµλ‹λ‹¤.

μ΄ κ²½μ° `to="."`λ¥Ό μ„¤μ •ν•μ—¬ λμ¨ν•κ² νƒ€μ…ν™”λ κ²€μƒ‰ νλΌλ―Έν„°μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤.  
λ‹¤μμ€ μ΄λ¥Ό μ„¤λ…ν•λ” μμ μ…λ‹λ‹¤:

```tsx
// `page`λ” __root κ²½λ΅μ— μ •μλ κ²€μƒ‰ νλΌλ―Έν„°μ΄λ©° λ¨λ“  κ²½λ΅μ—μ„ μ‚¬μ© κ°€λ¥ν•©λ‹λ‹¤.
const PageSelector = () => {
  return (
    <div>
      <Link to="." search={(prev) => ({ ...prev, page: prev.page + 1 })}>
        Next Page
      </Link>
    </div>
  );
};
```

μΌλ°μ μΈ μ»΄ν¬λ„νΈκ°€ κ²½λ΅ νΈλ¦¬μ νΉμ • ν•μ„ νΈλ¦¬μ—μ„λ§ λ λ”λ§λλ” κ²½μ°, `from`μ„ μ‚¬μ©ν•μ—¬ ν•΄λ‹Ή ν•μ„ νΈλ¦¬λ¥Ό μ§€μ •ν•  μ μμµλ‹λ‹¤. μ΄ κ²½μ° `to='.'`λ¥Ό μƒλµν•  μ μμµλ‹λ‹¤.

```tsx
// `page`λ” /posts κ²½λ΅μ— μ •μλ κ²€μƒ‰ νλΌλ―Έν„°μ΄λ©° λ¨λ“  ν•μ„ κ²½λ΅μ—μ„ μ‚¬μ© κ°€λ¥ν•©λ‹λ‹¤.
const PageSelector = () => {
  return (
    <div>
      <Link
        from="/posts"
        to="."
        search={(prev) => ({ ...prev, page: prev.page + 1 })}
      >
        Next Page
      </Link>
    </div>
  )
```

### `useNavigate(), navigate({ search })`

`navigate` ν•¨μλ„ `<Link />`μ `search` μ†μ„±κ³Ό λ™μΌν• λ°©μ‹μΌλ΅ μ‘λ™ν•λ” `search` μµμ…μ„ ν—μ©ν•©λ‹λ‹¤:

```tsx
// /routes/shop.products.tsx
export const Route = createFileRoute("/shop/products/$productId")({
  validateSearch: productSearchSchema,
});

const ProductList = () => {
  const navigate = useNavigate({ from: Route.fullPath });

  return (
    <div>
      <button
        onClick={() => {
          navigate({
            search: (prev) => ({ page: prev.page + 1 }),
          });
        }}
      >
        Next Page
      </button>
    </div>
  );
};
```

### `router.navigate({ search })`

`router.navigate` ν•¨μλ” μ„μ `useNavigate`/`navigate` ν›…/ν•¨μμ™€ λ™μΌν• λ°©μ‹μΌλ΅ μ‘λ™ν•©λ‹λ‹¤.

### `<Navigate search />`

`<Navigate search />` μ»΄ν¬λ„νΈλ„ μ„μ `useNavigate`/`navigate` ν›…/ν•¨μμ™€ λ™μΌν•κ² μ‘λ™ν•μ§€λ§, ν•¨μ μΈμ λ€μ‹  μ†μ„±μΌλ΅ μµμ…μ„ μ „λ‹¬ν•©λ‹λ‹¤.

## Transforming search with search middlewares

λ§ν¬μ hrefκ°€ μƒμ„±λ  λ•, κΈ°λ³Έμ μΌλ΅ μΏΌλ¦¬ λ¬Έμμ—΄ λ¶€λ¶„μ— μ¤‘μ”ν• κ²ƒμ€ `<Link>`μ `search` μ†μ„±μ…λ‹λ‹¤.

TanStack Routerλ” **search middlewares**λ¥Ό ν†µν•΄ href μƒμ„± μ „μ— κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ΅°μ‘ν•  μ μλ” λ°©λ²•μ„ μ κ³µν•©λ‹λ‹¤.  
Search middlewaresλ” κ²½λ΅ λλ” ν•μ„ κ²½λ΅μ— λ€ν• μƒ λ§ν¬λ¥Ό μƒμ„±ν•  λ• κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό λ³€ν™ν•λ” ν•¨μμ…λ‹λ‹¤. λν•, κ²€μƒ‰ κ²€μ¦ ν›„ νƒμƒ‰ μ‹ μΏΌλ¦¬ λ¬Έμμ—΄μ„ μ΅°μ‘ν•  μ μλ„λ΅ μ‹¤ν–‰λ©λ‹λ‹¤.

λ‹¤μμ€ λ¨λ“  λ§ν¬μ— λ€ν•΄ `rootValue` κ²€μƒ‰ νλΌλ―Έν„°κ°€ ν„μ¬ κ²€μƒ‰ νλΌλ―Έν„°μ— ν¬ν•¨λ κ²½μ° μ΄λ¥Ό μ¶”κ°€ν•λ„λ΅ μ„¤μ •ν•λ” μμ μ…λ‹λ‹¤. λ§ν¬κ°€ `search` λ‚΄λ¶€μ— `rootValue`λ¥Ό μ§€μ •ν•λ©΄ ν•΄λ‹Ή κ°’μ΄ λ§ν¬ μƒμ„±μ— μ‚¬μ©λ©λ‹λ‹¤.

```tsx
import { z } from "zod";
import { createFileRoute } from "@tanstack/react-router";
import { zodValidator } from "@tanstack/zod-adapter";

const searchSchema = z.object({
  rootValue: z.string().optional(),
});

export const Route = createRootRoute({
  validateSearch: zodValidator(searchSchema),
  search: {
    middlewares: [
      ({ search, next }) => {
        const result = next(search);
        return {
          rootValue: search.rootValue,
          ...result,
        };
      },
    ],
  },
});
```

μ΄ μ‚¬μ© μ‚¬λ΅€λ” λ§¤μ° μΌλ°μ μ΄λ―€λ΅ TanStack Routerλ” κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ μ§€ν•λ” `retainSearchParams`λ¥Ό μ κ³µν•©λ‹λ‹¤:

```tsx
import { z } from "zod";
import { createFileRoute, retainSearchParams } from "@tanstack/react-router";
import { zodValidator } from "@tanstack/zod-adapter";

const searchSchema = z.object({
  rootValue: z.string().optional(),
});

export const Route = createRootRoute({
  validateSearch: zodValidator(searchSchema),
  search: {
    middlewares: [retainSearchParams(["rootValue"])],
  },
});
```

λ λ‹¤λ¥Έ μΌλ°μ μΈ μ‚¬μ© μ‚¬λ΅€λ” κΈ°λ³Έκ°’μ΄ μ„¤μ •λ κ²½μ° λ§ν¬μ—μ„ κ²€μƒ‰ νλΌλ―Έν„°λ¥Ό μ κ±°ν•λ” κ²ƒμ…λ‹λ‹¤. TanStack Routerλ” μ΄ μ‚¬μ© μ‚¬λ΅€λ¥Ό μ²λ¦¬ν•κΈ° μ„ν•΄ `stripSearchParams`λ¥Ό μ κ³µν•©λ‹λ‹¤:

```tsx
import { z } from "zod";
import { createFileRoute, stripSearchParams } from "@tanstack/react-router";
import { zodValidator } from "@tanstack/zod-adapter";

const defaultValues = {
  one: "abc",
  two: "xyz",
};

const searchSchema = z.object({
  one: z.string().default(defaultValues.one),
  two: z.string().default(defaultValues.two),
});

export const Route = createFileRoute("/hello")({
  validateSearch: zodValidator(searchSchema),
  search: {
    // κΈ°λ³Έκ°’ μ κ±°
    middlewares: [stripSearchParams(defaultValues)],
  },
});
```

μ—¬λ¬ κ°μ λ―Έλ“¤μ›¨μ–΄λ¥Ό μ²΄μΈμΌλ΅ μ—°κ²°ν•  μ μμµλ‹λ‹¤. λ‹¤μμ€ `retainSearchParams`μ™€ `stripSearchParams`λ¥Ό κ²°ν•©ν•λ” μμ μ…λ‹λ‹¤.

```tsx
import {
  Link,
  createFileRoute,
  retainSearchParams,
  stripSearchParams,
} from "@tanstack/react-router";
import { z } from "zod";
import { zodValidator } from "@tanstack/zod-adapter";

const defaultValues = ["foo", "bar"];

export const Route = createFileRoute("/search")({
  validateSearch: zodValidator(
    z.object({
      retainMe: z.string().optional(),
      arrayWithDefaults: z.string().array().default(defaultValues),
      required: z.string(),
    })
  ),
  search: {
    middlewares: [
      retainSearchParams(["retainMe"]),
      stripSearchParams({ arrayWithDefaults: defaultValues }),
    ],
  },
});
```
