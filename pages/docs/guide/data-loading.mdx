---
id: data-loading
title: Data Loading
---

## Data Loading

ë°ì´í„° ë¡œë”©ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í”íˆ ë°œìƒí•˜ëŠ” ë¬¸ì œë¡œ ë¼ìš°íŒ…ê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í˜ì´ì§€ë¥¼ ë¡œë“œí•  ë•Œ, í•´ë‹¹ í˜ì´ì§€ì˜ ë¹„ë™ê¸° ìš”êµ¬ ì‚¬í•­ì„ ê°€ëŠ¥í•œ í•œ ë¹¨ë¦¬ ë³‘ë ¬ë¡œ ê°€ì ¸ì™€ ì¶©ì¡±ì‹œí‚¤ëŠ” ê²ƒì´ ì´ìƒì ì…ë‹ˆë‹¤. ë¼ìš°í„°ëŠ” ì½˜í…ì¸ ê°€ ë Œë”ë§ë˜ê¸° ì „ì— ì‚¬ìš©ìê°€ ì–´ë””ë¡œ ì´ë™í•˜ê³  ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìœ ì¼í•œ ìœ„ì¹˜ì´ë¯€ë¡œ ì´ëŸ¬í•œ ë¹„ë™ê¸° ì¢…ì†ì„±ì„ ì¡°ì •í•˜ê¸°ì— ê°€ì¥ ì í•©í•œ ìœ„ì¹˜ì…ë‹ˆë‹¤.

Next.jsì˜ `getServerSideProps`ë‚˜ Remix/React-Routerì˜ `loader`ì™€ ìœ ì‚¬í•œ ê¸°ëŠ¥ì´ TanStack Routerì—ë„ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë¼ìš°íŠ¸ë³„ë¡œ ìì‚°ì„ ì‚¬ì „ ë¡œë“œ/ë¡œë“œí•˜ì—¬ Reactê°€ ê°€ëŠ¥í•œ í•œ ë¹¨ë¦¬ ì„œìŠ¤íœìŠ¤ë¥¼ í†µí•´ ë Œë”ë§í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

ì´ì™€ ê°™ì€ ì¼ë°˜ì ì¸ ë¼ìš°í„° ê¸°ëŠ¥ ì™¸ì—ë„, TanStack RouterëŠ” **ë‚´ì¥ëœ SWR Caching**ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ëŠ” ë¼ìš°íŠ¸ ë¡œë”ë¥¼ ìœ„í•œ ì¥ê¸° ë©”ëª¨ë¦¬ ìºì‹± ê³„ì¸µìœ¼ë¡œ, ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ì¦‰ì‹œ ë¡œë“œí•˜ê±°ë‚˜ ì´ì „ì— ë°©ë¬¸í•œ ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ì„ì‹œë¡œ ìºì‹±í•˜ì—¬ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤.

## The route loading lifecycle

URL/íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸ê°€ ê°ì§€ë  ë•Œë§ˆë‹¤ ë¼ìš°í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤:

- Route Matching (Top-Down)
  - `route.params.parse`
  - `route.validateSearch`
- Route Pre-Loading (Serial)
  - `route.beforeLoad`
  - `route.onError`
    - `route.errorComponent` / `parentRoute.errorComponent` / `router.defaultErrorComponent`
- Route Loading (Parallel)
  - `route.component.preload?`
  - `route.loader`
    - `route.pendingComponent` (Optional)
    - `route.component`
  - `route.onError`
    - `route.errorComponent` / `parentRoute.errorComponent` / `router.defaultErrorComponent`

## To Router Cache or not to Router Cache?

TanStack Routerì˜ ìºì‹œëŠ” ëŒ€ë¶€ë¶„ì˜ ì†Œê·œëª¨ ë° ì¤‘ê°„ ê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì í•©í•  ê°€ëŠ¥ì„±ì´ ë†’ì§€ë§Œ, TanStack Queryì™€ ê°™ì€ ë” ê°•ë ¥í•œ ìºì‹± ì†”ë£¨ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

### TanStack Router Cache Pros

- ë‚´ì¥ë˜ì–´ ìˆìœ¼ë©° ì‚¬ìš©í•˜ê¸° ì‰½ê³  ì¶”ê°€ ì¢…ì†ì„±ì´ í•„ìš”í•˜ì§€ ì•ŠìŒ
- ë¼ìš°íŠ¸ë³„ë¡œ ë””ë“€í•‘, ì‚¬ì „ ë¡œë”©, ë¡œë”©, SWR, ë°±ê·¸ë¼ìš´ë“œ ë¦¬íŒ¨ì¹­ì„ ì²˜ë¦¬
- ëŒ€ê·œëª¨ ë¬´íš¨í™”(ëª¨ë“  ë¼ìš°íŠ¸ ë° ìºì‹œë¥¼ í•œ ë²ˆì— ë¬´íš¨í™”)
- ìë™ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
- ë¼ìš°íŠ¸ ê°„ ê³µìœ  ë°ì´í„°ê°€ ì ì€ ì•±ì— ì í•©
- SSRì—ì„œ "ê·¸ëƒ¥ ë™ì‘í•¨"

### TanStack Router Cache Cons

- ì˜êµ¬ ì €ì¥ì†Œ ì–´ëŒ‘í„°/ëª¨ë¸ ì—†ìŒ
- ë¼ìš°íŠ¸ ê°„ ê³µìœ  ìºì‹±/ë””ë“€í•‘ ì—†ìŒ
- ë‚´ì¥ëœ ë®¤í…Œì´ì…˜ API ì—†ìŒ (`useMutation` í›…ì´ ì˜ˆì œì—ì„œ ì œê³µë˜ë©° ë§ì€ ì‚¬ìš© ì‚¬ë¡€ì—ì„œ ì¶©ë¶„íˆ í™œìš© ê°€ëŠ¥)
- ë‚´ì¥ëœ ìºì‹œ ìˆ˜ì¤€ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ API ì—†ìŒ (ì»´í¬ë„ŒíŠ¸ ìˆ˜ì¤€ì—ì„œ `useMutation` í›…ê³¼ ê°™ì€ íœ˜ë°œì„± ìƒíƒœë¥¼ ì‚¬ìš©í•´ ì´ë¥¼ êµ¬í˜„ ê°€ëŠ¥)

> [!TIP]
> TanStack Queryì™€ ê°™ì€ ë” ê°•ë ¥í•œ ìºì‹± ì†”ë£¨ì…˜ì„ ì‚¬ìš©í•˜ë ¤ëŠ” ê²½ìš° [External Data Loading](./external-data-loading.md) ê°€ì´ë“œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

## Using the Router Cache

ë¼ìš°í„° ìºì‹œëŠ” ë‚´ì¥ë˜ì–´ ìˆìœ¼ë©°, ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ì—ì„œ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ì˜ˆì œë¥¼ í†µí•´ ë°°ì›Œë´…ì‹œë‹¤!

## Route `loader`s

ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ëŠ” ë¼ìš°íŠ¸ ë§¤ì¹­ì´ ë¡œë“œë  ë•Œ í˜¸ì¶œë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ ìœ ìš©í•œ ì†ì„±ì„ í¬í•¨í•˜ëŠ” ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤. ë‹¤ìŒì€ ê°„ë‹¨í•œ ì˜ˆì œì…ë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
});
```

## `loader` Parameters

`loader` í•¨ìˆ˜ëŠ” ë‹¤ìŒ ì†ì„±ì„ ê°€ì§„ ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ìŠµë‹ˆë‹¤:

- `abortController` - ë¼ìš°íŠ¸ì˜ AbortController. ë¼ìš°íŠ¸ê°€ ì–¸ë¡œë“œë˜ê±°ë‚˜ í˜¸ì¶œì´ ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šì„ ë•Œ ì‹ í˜¸ê°€ ì·¨ì†Œë©ë‹ˆë‹¤.
- `cause` - í˜„ì¬ ë¼ìš°íŠ¸ ë§¤ì¹­ì˜ ì›ì¸ìœ¼ë¡œ, `enter` ë˜ëŠ” `stay` ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.
- `context` - ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸ ê°ì²´ë¡œ, ìƒìœ„ ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸ì™€ `beforeLoad` ì˜µì…˜ì—ì„œ ì œê³µëœ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë³‘í•©í•œ ê°’ì…ë‹ˆë‹¤.
- `deps` - `Route.loaderDeps` í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ê°ì²´ ê°’ì…ë‹ˆë‹¤. ì •ì˜ë˜ì§€ ì•Šì€ ê²½ìš° ë¹ˆ ê°ì²´ê°€ ì œê³µë©ë‹ˆë‹¤.
- `location` - í˜„ì¬ ìœ„ì¹˜
- `params` - ë¼ìš°íŠ¸ì˜ ê²½ë¡œ ë§¤ê°œë³€ìˆ˜
- `parentMatchPromise` - `Promise<RouteMatch>` (`ë£¨íŠ¸ ë¼ìš°íŠ¸ì˜ ê²½ìš° undefined`)
- `preload` - ë¼ìš°íŠ¸ê°€ ë¡œë“œ ëŒ€ì‹  ì‚¬ì „ ë¡œë“œ ì¤‘ì¸ì§€ ë‚˜íƒ€ë‚´ëŠ” Boolean ê°’
- `route` - ë¼ìš°íŠ¸ ê°ì²´ ìì²´

## Consuming data from `loader`s

`loader`ì˜ ë°ì´í„°ë¥¼ ì†Œë¹„í•˜ë ¤ë©´ Route ê°ì²´ì— ì •ì˜ëœ `useLoaderData` í›…ì„ ì‚¬ìš©í•˜ì„¸ìš”.

```tsx
const posts = Route.useLoaderData();
```

ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ê¹Šìˆ™í•œ ê³³ì—ì„œ ë¼ìš°íŠ¸ ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤ë©´ `getRouteApi`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ í›… ë° Route ê°ì²´ì˜ ë‹¤ë¥¸ í›…ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¼ìš°íŠ¸ ê°ì²´ë¥¼ ì§ì ‘ ê°€ì ¸ì˜¤ëŠ” ê²ƒë³´ë‹¤ ì„ í˜¸ë˜ë©° ìˆœí™˜ ì¢…ì†ì„±ì„ ìƒì„±í•  ê°€ëŠ¥ì„±ì„ ì¤„ì…ë‹ˆë‹¤.

```tsx
import { getRouteApi } from "@tanstack/react-router";

// ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ

const routeApi = getRouteApi("/posts");
const data = routeApi.useLoaderData();
```

## Dependency-based Stale-While-Revalidate Caching

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”ë¥¼ ìœ„í•œ ë‚´ì¥ Stale-While-Revalidate ìºì‹± ê³„ì¸µì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ìºì‹±ì€ ë¼ìš°íŠ¸ì˜ ì¢…ì†ì„±ì— ê¸°ë°˜í•©ë‹ˆë‹¤:

- ë¼ìš°íŠ¸ì˜ ì™„ì „íˆ íŒŒì‹±ëœ ê²½ë¡œ ì´ë¦„
  - ì˜ˆ: `/posts/1` vs `/posts/2`
- `loaderDeps` ì˜µì…˜ìœ¼ë¡œ ì œê³µë˜ëŠ” ì¶”ê°€ ì¢…ì†ì„±
  - ì˜ˆ: `loaderDeps: ({ search: { pageIndex, pageSize } }) => ({ pageIndex, pageSize })`

ì´ ì¢…ì†ì„±ì„ í‚¤ë¡œ ì‚¬ìš©í•˜ì—¬ TanStack RouterëŠ” ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ë°ì´í„°ë¥¼ ìºì‹±í•˜ê³  ë™ì¼í•œ ë¼ìš°íŠ¸ ë§¤ì¹­ì— ëŒ€í•œ í›„ì† ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì¦‰, ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì´ë¯¸ ìºì‹œì— ìˆë‹¤ë©´ ì¦‰ì‹œ ë°˜í™˜ë˜ë©°, ë°ì´í„°ì˜ "ì‹ ì„ ë„"ì— ë”°ë¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ìƒˆë¡œê³ ì¹¨ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### Key options

ë¼ìš°íŠ¸ ì¢…ì†ì„±ê³¼ "ì‹ ì„ ë„"ë¥¼ ì œì–´í•˜ê¸° ìœ„í•´ TanStack RouterëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. ë‹¤ìŒì€ ì‚¬ìš© ë¹ˆë„ê°€ ë†’ì€ ìˆœì„œëŒ€ë¡œ ì •ë¦¬ëœ ì˜µì…˜ë“¤ì…ë‹ˆë‹¤:

- `routeOptions.loaderDeps`
  - ë¼ìš°í„°ì˜ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê³µí•˜ê³  ì´ë¥¼ `loader` í•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•  ì¢…ì†ì„± ê°ì²´ë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¢…ì†ì„±ì´ íƒìƒ‰ ê°„ì— ë³€ê²½ë˜ë©´ `staleTime` ê°’ê³¼ ê´€ê³„ì—†ì´ ë¼ìš°íŠ¸ê°€ ë‹¤ì‹œ ë¡œë“œë©ë‹ˆë‹¤. ì¢…ì†ì„±ì€ ê¹Šì€ ë™ë“±ì„± ë¹„êµë¥¼ í†µí•´ ë¹„êµë©ë‹ˆë‹¤.
- `routeOptions.staleTime`
- `routerOptions.defaultStaleTime`
  - ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ë¡œë“œí•  ë•Œ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ë°€ë¦¬ì´ˆ ìˆ˜ì…ë‹ˆë‹¤.
- `routeOptions.preloadStaleTime`
- `routerOptions.defaultPreloadStaleTime`
  - ì‚¬ì „ ë¡œë“œ ì‹œ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ë°€ë¦¬ì´ˆ ìˆ˜ì…ë‹ˆë‹¤.
- `routeOptions.gcTime`
- `routerOptions.defaultGcTime`
  - ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ìºì‹œì— ìœ ì§€ë˜ëŠ” ì‹œê°„(ë°€ë¦¬ì´ˆ)ì…ë‹ˆë‹¤.
- `routeOptions.shouldReload`
  - `beforeLoad` ë° `loaderContext` ë§¤ê°œë³€ìˆ˜ì™€ ë™ì¼í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ê³  ë¼ìš°íŠ¸ë¥¼ ë‹¤ì‹œ ë¡œë“œí• ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¶€ìš¸ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì€ `staleTime` ë° `loaderDeps` ì™¸ì—ë„ ë¼ìš°íŠ¸ë¥¼ ë‹¤ì‹œ ë¡œë“œí•´ì•¼ í•˜ëŠ” ì‹œì ì„ ì œì–´í•  ìˆ˜ ìˆëŠ” ì¶”ê°€ì ì¸ ì œì–´ ìˆ˜ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤. Remixì˜ `shouldLoad` ì˜µì…˜ê³¼ ìœ ì‚¬í•œ íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### âš ï¸ Some Important Defaults

- ê¸°ë³¸ì ìœ¼ë¡œ `staleTime`ì€ `0`ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¦‰, ë¼ìš°íŠ¸ ë°ì´í„°ëŠ” í•­ìƒ ì‹ ì„ í•˜ì§€ ì•Šì€ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ë©° ë¼ìš°íŠ¸ê°€ ë‹¤ì‹œ ë§¤ì¹­ë  ë•Œë§ˆë‹¤ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë‹¤ì‹œ ë¡œë“œë©ë‹ˆë‹¤.
- ê¸°ë³¸ì ìœ¼ë¡œ, ì‚¬ì „ ë¡œë“œëœ ë¼ìš°íŠ¸ëŠ” **30ì´ˆ** ë™ì•ˆ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë©ë‹ˆë‹¤. ì¦‰, ì‚¬ì „ ë¡œë“œëœ ë¼ìš°íŠ¸ê°€ 30ì´ˆ ë‚´ì— ë‹¤ì‹œ ì‚¬ì „ ë¡œë“œë˜ë©´ ë‘ ë²ˆì§¸ ì‚¬ì „ ë¡œë“œëŠ” ë¬´ì‹œë©ë‹ˆë‹¤. ì´ëŠ” ë¶ˆí•„ìš”í•œ ì‚¬ì „ ë¡œë“œê°€ ë„ˆë¬´ ìì£¼ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ë°©ì§€í•©ë‹ˆë‹¤. **ë¼ìš°íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë  ë•ŒëŠ” ê¸°ë³¸ `staleTime` ê°’ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.**
- ê¸°ë³¸ì ìœ¼ë¡œ `gcTime`ì€ **30ë¶„**ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” 30ë¶„ ë™ì•ˆ ì ‘ê·¼ë˜ì§€ ì•Šì€ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ìºì‹œì—ì„œ ê°€ë¹„ì§€ ìˆ˜ì§‘ë˜ê³  ì œê±°ëœë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
- `router.invalidate()`ëŠ” ëª¨ë“  í™œì„± ë¼ìš°íŠ¸ê°€ ì¦‰ì‹œ ë¡œë”ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ë„ë¡ ê°•ì œí•˜ë©°, ëª¨ë“  ìºì‹œëœ ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ì‹ ì„ í•˜ì§€ ì•Šì€ ê²ƒìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.

### Using `loaderDeps` to access search params

`/posts` ë¼ìš°íŠ¸ê°€ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ `offset` ë° `limit`ì„ í†µí•´ ì¼ë¶€ í˜ì´ì§€ ë§¤ê¹€ì„ ì§€ì›í•œë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤. ìºì‹œì—ì„œ ì´ ë°ì´í„°ë¥¼ ê³ ìœ í•˜ê²Œ ì €ì¥í•˜ë ¤ë©´ `loaderDeps` í•¨ìˆ˜ë¥¼ í†µí•´ ì´ëŸ¬í•œ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ì— ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‹ë³„í•˜ë©´, `/posts`ì— ëŒ€í•´ ë‹¤ë¥¸ `offset` ë° `limit` ê°’ì„ ê°€ì§„ ê° ë¼ìš°íŠ¸ ë§¤ì¹­ì´ í˜¼í•©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì´ ì¢…ì†ì„±ì„ ì„¤ì •í•˜ë©´ ì¢…ì†ì„±ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë¼ìš°íŠ¸ê°€ í•­ìƒ ë‹¤ì‹œ ë¡œë“œë©ë‹ˆë‹¤.

```tsx
// /routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loaderDeps: ({ search: { offset, limit } }) => ({ offset, limit }),
  loader: ({ deps: { offset, limit } }) =>
    fetchPosts({
      offset,
      limit,
    }),
});
```

### Using `staleTime` to control how long data is considered fresh

ê¸°ë³¸ì ìœ¼ë¡œ íƒìƒ‰ ì‹œ `staleTime`ì€ `0`ms(ì‚¬ì „ ë¡œë“œì˜ ê²½ìš° 30ì´ˆ)ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¼ìš°íŠ¸ ë°ì´í„°ê°€ í•­ìƒ ì‹ ì„ í•˜ì§€ ì•Šì€ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ë©°, ë¼ìš°íŠ¸ê°€ ë§¤ì¹­ë˜ê³  íƒìƒ‰ë  ë•Œë§ˆë‹¤ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë‹¤ì‹œ ë¡œë“œë¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

**ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš© ì‚¬ë¡€ì—ì„œ ì´ ê¸°ë³¸ê°’ì€ ì í•©í•˜ì§€ë§Œ, ì¼ë¶€ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ë” ì •ì ì´ê±°ë‚˜ ë¡œë“œ ë¹„ìš©ì´ ë¹„ì‹¸ë‹¤ë©´ `staleTime` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰ ì‹œ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ê¸°ê°„ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.** ë‹¤ìŒì€ ì˜ˆì œì…ë‹ˆë‹¤:

```tsx
// /routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  // 10ì´ˆ ë™ì•ˆ ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼í•©ë‹ˆë‹¤.
  staleTime: 10_000,
});
```

`staleTime` ì˜µì…˜ì— `10_000`ì„ ì „ë‹¬í•˜ë©´, ë¼ìš°í„°ëŠ” ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ 10ì´ˆ ë™ì•ˆ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼í•©ë‹ˆë‹¤. ì´ëŠ” ì‚¬ìš©ìê°€ `/about`ì—ì„œ `/posts`ë¡œ íƒìƒ‰í•  ë•Œ, ë§ˆì§€ë§‰ ë¡œë” ê²°ê³¼ë¡œë¶€í„° 10ì´ˆ ì´ë‚´ë¼ë©´ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ë‹¤ì‹œ ë¡œë“œë˜ì§€ ì•ŠìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ 10ì´ˆ í›„ì— `/about`ì—ì„œ `/posts`ë¡œ íƒìƒ‰í•˜ë©´ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ **ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë‹¤ì‹œ ë¡œë“œ**ë©ë‹ˆë‹¤.

## Turning off stale-while-revalidate caching

ë¼ìš°íŠ¸ì— ëŒ€í•´ Stale-While-Revalidate ìºì‹±ì„ ë¹„í™œì„±í™”í•˜ë ¤ë©´ `staleTime` ì˜µì…˜ì„ `Infinity`ë¡œ ì„¤ì •í•˜ì‹­ì‹œì˜¤:

```tsx
// /routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  staleTime: Infinity,
});
```

ëª¨ë“  ë¼ìš°íŠ¸ì— ëŒ€í•´ ì´ë¥¼ ë¹„í™œì„±í™”í•˜ë ¤ë©´ ë¼ìš°í„°ì˜ `defaultStaleTime` ì˜µì…˜ì„ ì„¤ì •í•˜ì‹­ì‹œì˜¤:

```tsx
const router = createRouter({
  routeTree,
  defaultStaleTime: Infinity,
});
```

## Using `shouldReload` and `gcTime` to opt-out of caching

Remixì˜ ê¸°ë³¸ ê¸°ëŠ¥ê³¼ ìœ ì‚¬í•˜ê²Œ, ë¼ìš°íŠ¸ë¥¼ ì²˜ìŒ ì§„ì… ì‹œ ë˜ëŠ” ì£¼ìš” ë¡œë” ì¢…ì†ì„±ì´ ë³€ê²½ë  ë•Œë§Œ ë¡œë“œí•˜ë„ë¡ êµ¬ì„±í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” `gcTime` ì˜µì…˜ê³¼ `shouldReload` ì˜µì…˜ì„ ì¡°í•©í•˜ì—¬ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `shouldReload` ì˜µì…˜ì€ `boolean` ê°’ì„ ë°›ê±°ë‚˜ `beforeLoad` ë° `loaderContext`ì™€ ë™ì¼í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ê³  ë¼ìš°íŠ¸ë¥¼ ë‹¤ì‹œ ë¡œë“œí• ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¶€ìš¸ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// /routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loaderDeps: ({ search: { offset, limit } }) => ({ offset, limit }),
  loader: ({ deps }) => fetchPosts(deps),
  // ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì–¸ë¡œë“œëœ í›„ ìºì‹œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  gcTime: 0,
  // ì‚¬ìš©ìê°€ ë¼ìš°íŠ¸ë¡œ ì´ë™í•˜ê±°ë‚˜ ì¢…ì†ì„±ì´ ë³€ê²½ë  ë•Œë§Œ ë¼ìš°íŠ¸ë¥¼ ë‹¤ì‹œ ë¡œë“œí•©ë‹ˆë‹¤.
  shouldReload: false,
});
```

### Opting out of caching while still preloading

ë¼ìš°íŠ¸ ë°ì´í„°ì— ëŒ€í•´ ë‹¨ê¸° ìºì‹±ì„ ë¹„í™œì„±í™”í•˜ë”ë¼ë„, ì‚¬ì „ ë¡œë“œì˜ ì´ì ì„ ì—¬ì „íˆ ëˆ„ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤! ìœ„ì˜ êµ¬ì„±ì—ì„œëŠ” ê¸°ë³¸ `preloadGcTime`ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ì „ ë¡œë“œê°€ ê³„ì† "ê·¸ëƒ¥ ë™ì‘"í•©ë‹ˆë‹¤. ì¦‰, ë¼ìš°íŠ¸ë¥¼ ì‚¬ì „ ë¡œë“œí•œ í›„ íƒìƒ‰í•˜ë©´ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ë©° ë‹¤ì‹œ ë¡œë“œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì‚¬ì „ ë¡œë“œë¥¼ ë¹„í™œì„±í™”í•˜ë ¤ë©´ `routerOptions.defaultPreload` ë˜ëŠ” `routeOptions.preload` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.

## Passing all loader events to an external cache

ì´ ì‚¬ìš© ì‚¬ë¡€ëŠ” [External Data Loading](./external-data-loading.md) í˜ì´ì§€ì—ì„œ ë” ìì„¸íˆ ì„¤ëª…ë˜ì§€ë§Œ, TanStack Queryì™€ ê°™ì€ ì™¸ë¶€ ìºì‹œë¥¼ ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” ê²½ìš° ëª¨ë“  ë¡œë” ì´ë²¤íŠ¸ë¥¼ ì™¸ë¶€ ìºì‹œì— ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•˜ëŠ” í•œ, ë³€ê²½í•´ì•¼ í•  ìœ ì¼í•œ ì‚¬í•­ì€ ë¼ìš°í„°ì˜ `defaultPreloadStaleTime` ì˜µì…˜ì„ `0`ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

```tsx
const router = createRouter({
  routeTree,
  defaultPreloadStaleTime: 0,
});
```

ì´ë ‡ê²Œ í•˜ë©´ ëª¨ë“  ì‚¬ì „ ë¡œë“œ, ë¡œë“œ, ë¦¬ë¡œë“œ ì´ë²¤íŠ¸ê°€ `loader` í•¨ìˆ˜ë¥¼ íŠ¸ë¦¬ê±°í•˜ë©°, ì´ í•¨ìˆ˜ëŠ” ì™¸ë¶€ ìºì‹œì—ì„œ ì²˜ë¦¬ë˜ê³  ë””ë“€í•‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Using Router Context

`loader` í•¨ìˆ˜ì— ì „ë‹¬ë˜ëŠ” `context` ë§¤ê°œë³€ìˆ˜ëŠ” ë‹¤ìŒì„ ë³‘í•©í•œ ê°ì²´ì…ë‹ˆë‹¤:

- ìƒìœ„ ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸
- `beforeLoad` ì˜µì…˜ì—ì„œ ì œê³µëœ í˜„ì¬ ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸

ë¼ìš°í„°ì˜ ìµœìƒë‹¨ì—ì„œ `context` ì˜µì…˜ì„ í†µí•´ ì´ˆê¸° ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¼ìš°í„°ì— ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” ë¼ìš°í„°ì˜ ëª¨ë“  ë¼ìš°íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ë¼ìš°íŠ¸ê°€ ë§¤ì¹­ë  ë•Œë§ˆë‹¤ ê° ë¼ìš°íŠ¸ì— ë³µì‚¬ë˜ê³  í™•ì¥ë©ë‹ˆë‹¤. ì´ëŠ” `beforeLoad` ì˜µì…˜ì„ í†µí•´ ë¼ìš°íŠ¸ì— ì»¨í…ìŠ¤íŠ¸ë¥¼ ì „ë‹¬í•¨ìœ¼ë¡œì¨ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” ë¼ìš°íŠ¸ì˜ ëª¨ë“  ìì‹ ë¼ìš°íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°ê³¼ ì»¨í…ìŠ¤íŠ¸ëŠ” ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

ë‹¤ìŒ ì˜ˆì œì—ì„œëŠ” ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê²Œì‹œê¸€ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ë¥¼ ìƒì„±í•œ ë‹¤ìŒ ì´ë¥¼ `loader` í•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

> ğŸ§  ì»¨í…ìŠ¤íŠ¸ëŠ” ì˜ì¡´ì„± ì£¼ì…ì„ ìœ„í•œ ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤, í›…, ê¸°íƒ€ ê°ì²´ë¥¼ ë¼ìš°í„° ë° ë¼ìš°íŠ¸ì— ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë¼ìš°íŠ¸ì˜ `beforeLoad` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë¼ìš°íŠ¸ íŠ¸ë¦¬ë¥¼ ë”°ë¼ ë°ì´í„°ë¥¼ ì ì§„ì ìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

- `/utils/fetchPosts.tsx`

```tsx
export const fetchPosts = async () => {
  const res = await fetch(`/api/posts?page=${pageIndex}`);
  if (!res.ok) throw new Error("Failed to fetch posts");
  return res.json();
};
```

- `/routes/__root.tsx`

```tsx
import { createRootRouteWithContext } from "@tanstack/react-router";

// createRootRouteWithContext<{...}>() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë£¨íŠ¸ ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•˜ê³ , ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íƒ€ì…ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
export const Route = createRootRouteWithContext<{
  fetchPosts: typeof fetchPosts;
}>()(); // ì£¼ì˜: ì´ì¤‘ í˜¸ì¶œì€ ì˜ë„ëœ ê²ƒì´ë©°, createRootRouteWithContextëŠ” íŒ©í† ë¦¬ í•¨ìˆ˜ì…ë‹ˆë‹¤.
```

- `/routes/posts.tsx`

```tsx
import { createFileRoute } from "@tanstack/react-router";

// postsRouteê°€ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì°¸ì¡°í•˜ì—¬ fetchPosts í•¨ìˆ˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.
// ì´ëŠ” ë¼ìš°í„°ì™€ ë¼ìš°íŠ¸ ì „ë°˜ì—ì„œ ì˜ì¡´ì„± ì£¼ì…ì„ ìœ„í•œ ê°•ë ¥í•œ ë„êµ¬ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
export const Route = createFileRoute("/posts")({
  loader: ({ context: { fetchPosts } }) => fetchPosts(),
});
```

- `/router.tsx`

```tsx
import { routeTree } from "./routeTree.gen";

// routerContextë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆ ë¼ìš°í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
// ì´ëŠ” routerContextì˜ íƒ€ì… ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤.
const router = createRouter({
  routeTree,
  context: {
    // fetchPosts í•¨ìˆ˜ë¥¼ ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ì— ì œê³µ
    fetchPosts,
  },
});
```

## Using Path Params

`loader` í•¨ìˆ˜ì—ì„œ ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ í•¨ìˆ˜ ë§¤ê°œë³€ìˆ˜ì˜ `params` ì†ì„±ì„ í†µí•´ ì ‘ê·¼í•˜ì„¸ìš”. ë‹¤ìŒì€ ì˜ˆì œì…ë‹ˆë‹¤:

```tsx
// routes/posts.$postId.tsx
export const Route = createFileRoute("/posts/$postId")({
  loader: ({ params: { postId } }) => fetchPostById(postId),
});
```

## Using Route Context

ì „ì—­ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¼ìš°í„°ì— ì „ë‹¬í•˜ëŠ” ê²ƒì€ ìœ ìš©í•˜ì§€ë§Œ, íŠ¹ì • ë¼ìš°íŠ¸ì— ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•´ì•¼ í•œë‹¤ë©´ ì–´ë–»ê²Œ í• ê¹Œìš”? ì—¬ê¸°ì„œ `beforeLoad` ì˜µì…˜ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. `beforeLoad` ì˜µì…˜ì€ ë¼ìš°íŠ¸ë¥¼ ë¡œë“œí•˜ê¸° ì§ì „ì— ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ë¡œ, `loader`ì™€ ë™ì¼í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì ì¬ì ì¸ ë§¤ì¹­ì„ ë¦¬ë””ë ‰ì…˜í•˜ê±°ë‚˜, ë¡œë” ìš”ì²­ì„ ì°¨ë‹¨í•˜ëŠ” ë“±ì˜ ê¸°ëŠ¥ ì™¸ì—ë„, ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸ì— ë³‘í•©ë  ê°ì²´ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒì€ `beforeLoad` ì˜µì…˜ì„ í†µí•´ ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ë°ì´í„°ë¥¼ ì£¼ì…í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤:

```tsx
// /routes/posts.tsx
import { createFileRoute } from "@tanstack/react-router";

export const Route = createFileRoute("/posts")({
  // fetchPosts í•¨ìˆ˜ë¥¼ ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ì „ë‹¬
  beforeLoad: () => ({
    fetchPosts: () => console.info("foo"),
  }),
  loader: ({ context: { fetchPosts } }) => {
    console.info(fetchPosts()); // 'foo'

    // ...
  },
});
```

## Using Search Params in Loaders

> â“ ê·¸ëŸ°ë° Tanner... ë‚´ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ëŠ” ì–´ë”” ìˆë‚˜ìš”?!

ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ê°€ `loader` í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ì—ì„œ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì´ìœ ê°€ ê¶ê¸ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì˜ë„ì ìœ¼ë¡œ ì„¤ê³„í•œ ì´ìœ ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:

- `loader` í•¨ìˆ˜ì—ì„œ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ í•´ë‹¹ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ê°€ ë¡œë“œëœ ë°ì´í„°ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ë˜ì–´ì•¼ í•¨ì„ ë‚˜íƒ€ë‚´ëŠ” ì¢‹ì€ ì§€í‘œì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `pageIndex`ì™€ ê°™ì€ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¼ìš°íŠ¸ê°€ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ì„¸ìš”. ì´ ê²½ìš°, `pageIndex`ëŠ” ë¼ìš°íŠ¸ ë§¤ì¹­ ë‚´ ë°ì´í„°ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•©ë‹ˆë‹¤. `/users/user` ë¼ìš°íŠ¸ê°€ `userId` ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‚¬ìš©ìë¥¼ ì‹ë³„í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒìƒí•´ ë³´ì„¸ìš”. URLì€ `/users/user?userId=123`ì™€ ê°™ì´ ëª¨ë¸ë§ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° `user` ë¼ìš°íŠ¸ëŠ” íŠ¹ì • ì‚¬ìš©ìë¥¼ ì‹ë³„í•˜ëŠ” ë° ì¶”ê°€ì ì¸ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤.
- ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ë¥¼ `loader` í•¨ìˆ˜ì—ì„œ ì§ì ‘ ì ‘ê·¼í•˜ë©´, ë¡œë“œëœ ë°ì´í„°ê°€ í˜„ì¬ URL ê²½ë¡œ ì´ë¦„ ë° ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ì™€ ê³ ìœ í•˜ì§€ ì•Šì„ ë•Œ ìºì‹± ë° ì‚¬ì „ ë¡œë“œì™€ ê´€ë ¨ëœ ë²„ê·¸ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `/posts` ë¼ìš°íŠ¸ì—ì„œ 2í˜ì´ì§€ì˜ ê²°ê³¼ë¥¼ ì‚¬ì „ ë¡œë“œí•˜ë„ë¡ ìš”ì²­í–ˆì§€ë§Œ, ë¼ìš°íŠ¸ êµ¬ì„±ì—ì„œ í˜ì´ì§€ ê°„ì˜ êµ¬ë¶„ì´ ì—†ìœ¼ë©´ `/posts` ë˜ëŠ” `?page=1` í™”ë©´ì—ì„œ 2í˜ì´ì§€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì €ì¥í•˜ê³  í‘œì‹œí•˜ê²Œ ë©ë‹ˆë‹¤.
- ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ì™€ `loader` í•¨ìˆ˜ ê°„ì— ê¸°ì¤€ì„ ë‘ë©´ ë¼ìš°í„°ê°€ ì¢…ì†ì„±ê³¼ ë°˜ì‘ì„±ì„ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// /routes/users.user.tsx
export const Route = createFileRoute("/users/user")({
  validateSearch: (search) =>
    search as {
      userId: string;
    },
  loaderDeps: ({ search: { userId } }) => ({
    userId,
  }),
  loader: async ({ deps: { userId } }) => getUser(userId),
});
```

### Accessing Search Params via `routeOptions.loaderDeps`

```tsx
// /routes/posts.tsx
export const Route = createFileRoute("/posts")({
  // zodë¥¼ ì‚¬ìš©í•˜ì—¬ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ë¥¼ ê²€ì¦í•˜ê³  íŒŒì‹±
  validateSearch: z.object({
    offset: z.number().int().nonnegative().catch(0),
  }),
  // loaderDeps í•¨ìˆ˜ë¥¼ í†µí•´ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ offsetì„ ì „ë‹¬
  loaderDeps: ({ search: { offset } }) => ({ offset }),
  // loader í•¨ìˆ˜ì—ì„œ ì»¨í…ìŠ¤íŠ¸ì—ì„œ offset ì‚¬ìš©
  loader: async ({ deps: { offset } }) =>
    fetchPosts({
      offset,
    }),
});
```

## Using the Abort Signal

`loader` í•¨ìˆ˜ì˜ `abortController` ì†ì„±ì€ [AbortController](https://developer.mozilla.org/en-US/docs/Web/API/AbortController)ì…ë‹ˆë‹¤. ë¼ìš°íŠ¸ê°€ ì–¸ë¡œë“œë˜ê±°ë‚˜ `loader` í˜¸ì¶œì´ ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šì„ ë•Œ ì‹ í˜¸ê°€ ì·¨ì†Œë©ë‹ˆë‹¤. ì´ëŠ” ë¼ìš°íŠ¸ê°€ ì–¸ë¡œë“œë˜ê±°ë‚˜ ë¼ìš°íŠ¸ì˜ ë§¤ê°œë³€ìˆ˜ê°€ ë³€ê²½ë  ë•Œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ì·¨ì†Œí•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” fetch í˜¸ì¶œê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: ({ abortController }) =>
    fetchPosts({
      // í•˜ìœ„ fetch í˜¸ì¶œ ë˜ëŠ” ì‹ í˜¸ë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ì‘ì—…ì— ì „ë‹¬
      signal: abortController.signal,
    }),
});
```

## Using the `preload` flag

`loader` í•¨ìˆ˜ì˜ `preload` ì†ì„±ì€ ë¼ìš°íŠ¸ê°€ ë¡œë“œ ëŒ€ì‹  ì‚¬ì „ ë¡œë“œ ì¤‘ì¼ ë•Œ `true`ì¸ ë¶€ìš¸ ê°’ì…ë‹ˆë‹¤. ì¼ë¶€ ë°ì´í„° ë¡œë”© ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” í‘œì¤€ fetchì™€ ë‹¤ë¥´ê²Œ ì‚¬ì „ ë¡œë“œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ `preload`ë¥¼ ë°ì´í„° ë¡œë”© ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì „ë‹¬í•˜ê±°ë‚˜ ì ì ˆí•œ ë°ì´í„° ë¡œë”© ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: async ({ preload }) =>
    fetchPosts({
      maxAge: preload ? 10_000 : 0, // ì‚¬ì „ ë¡œë“œëŠ” ì¡°ê¸ˆ ë” ì˜¤ë˜ ìœ ì§€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
    }),
});
```

## Handling Slow Loaders

ëŒ€ë¶€ë¶„ì˜ ë¼ìš°íŠ¸ ë¡œë”ëŠ” ì§§ì€ ì‹œê°„ ë‚´ì— ë°ì´í„°ë¥¼ í•´ê²°í•˜ì—¬ í”Œë ˆì´ìŠ¤í™€ë” ìŠ¤í”¼ë„ˆë¥¼ ë Œë”ë§í•  í•„ìš” ì—†ì´ ì„œìŠ¤íœìŠ¤ë¥¼ í†µí•´ ë‹¤ìŒ ë¼ìš°íŠ¸ë¥¼ ì™„ì „íˆ ì¤€ë¹„ë˜ì—ˆì„ ë•Œ ë Œë”ë§í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë¼ìš°íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” ë° í•„ìš”í•œ ì¤‘ìš”í•œ ë°ì´í„°ê°€ ëŠë¦° ê²½ìš° ë‹¤ìŒ ë‘ ê°€ì§€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤:

- ë¹ ë¥¸ ë°ì´í„°ì™€ ëŠë¦° ë°ì´í„°ë¥¼ ë³„ë„ì˜ promiseë¡œ ë‚˜ëˆ„ê³  ëŠë¦° ë°ì´í„°ë¥¼ ë¹ ë¥¸ ë°ì´í„°ê°€ ë¡œë“œëœ í›„ê¹Œì§€ `defer`(ì§€ì—°)í•©ë‹ˆë‹¤. ([Deferred Data Loading](./deferred-data-loading.md) ê°€ì´ë“œ ì°¸ì¡°)
- ëª¨ë“  ë°ì´í„°ê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ë‚™ê´€ì  ì„œìŠ¤íœìŠ¤ ì„ê³„ê°’ ì´í›„ì— ëŒ€ê¸° ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤. (ì•„ë˜ ì°¸ì¡°)

## Showing a pending component

**ê¸°ë³¸ì ìœ¼ë¡œ TanStack RouterëŠ” í•´ê²° ì‹œê°„ì´ 1ì´ˆë¥¼ ì´ˆê³¼í•˜ëŠ” ë¡œë”ì— ëŒ€í•´ ëŒ€ê¸° ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.** ì´ ë‚™ê´€ì  ì„ê³„ê°’ì€ ë‹¤ìŒì„ í†µí•´ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- `routeOptions.pendingMs` ë˜ëŠ”
- `routerOptions.defaultPendingMs`

ëŒ€ê¸° ì‹œê°„ì´ ì´ˆê³¼ë˜ë©´, ë¼ìš°í„°ëŠ” ë¼ìš°íŠ¸ì˜ `pendingComponent` ì˜µì…˜ì„ ë Œë”ë§í•©ë‹ˆë‹¤(êµ¬ì„±ëœ ê²½ìš°).

## Avoiding Pending Component Flash

ëŒ€ê¸° ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ëŒ€ê¸° ì‹œê°„ ì„ê³„ê°’ì´ ì¶©ì¡±ëœ í›„ ë°ì´í„°ê°€ ë°”ë¡œ í•´ê²°ë˜ì–´ ëŒ€ê¸° ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ê°€ ê¹œë¹¡ì´ëŠ” ìƒí™©ì„ ì›ì¹˜ ì•Šì„ ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ **TanStack RouterëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ëŒ€ê¸° ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ìµœì†Œ 500ms ë™ì•ˆ í‘œì‹œí•©ë‹ˆë‹¤.** ì´ ë‚™ê´€ì  ì„ê³„ê°’ì€ ë‹¤ìŒì„ í†µí•´ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- `routeOptions.pendingMinMs` ë˜ëŠ”
- `routerOptions.defaultPendingMinMs`

## Handling Errors

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”© ë¼ì´í”„ì‚¬ì´í´ ì¤‘ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•˜ëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤. ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

### Handling Errors with `routeOptions.onError`

`routeOptions.onError` ì˜µì…˜ì€ ë¼ìš°íŠ¸ ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  onError: ({ error }) => {
    // ì˜¤ë¥˜ ë¡œê·¸ ê¸°ë¡
    console.error(error);
  },
});
```

### Handling Errors with `routeOptions.onCatch`

`routeOptions.onCatch` ì˜µì…˜ì€ ë¼ìš°í„°ì˜ CatchBoundaryì—ì„œ ì˜¤ë¥˜ê°€ ì¡í˜”ì„ ë•Œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  onCatch: ({ error, errorInfo }) => {
    // ì˜¤ë¥˜ ë¡œê·¸ ê¸°ë¡
    console.error(error);
  },
});
```

### Handling Errors with `routeOptions.errorComponent`

`routeOptions.errorComponent` ì˜µì…˜ì€ ë¼ìš°íŠ¸ ë¡œë”© ë˜ëŠ” ë Œë”ë§ ë¼ì´í”„ì‚¬ì´í´ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œ ë Œë”ë§ë˜ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. ì´ ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ propsë¥¼ ì‚¬ìš©í•˜ì—¬ ë Œë”ë§ë©ë‹ˆë‹¤:

- `error` - ë°œìƒí•œ ì˜¤ë¥˜
- `reset` - ë‚´ë¶€ `CatchBoundary`ë¥¼ ì¬ì„¤ì •í•˜ëŠ” í•¨ìˆ˜

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  errorComponent: ({ error }) => {
    // ì˜¤ë¥˜ ë©”ì‹œì§€ ë Œë”ë§
    return <div>{error.message}</div>;
  },
});
```

`reset` í•¨ìˆ˜ëŠ” ì‚¬ìš©ìê°€ ì—ëŸ¬ ê²½ê³„ì˜ ì¼ë°˜ì ì¸ ìì‹ì„ ë‹¤ì‹œ ë Œë”ë§í•˜ë„ë¡ ì¬ì‹œë„í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  errorComponent: ({ error, reset }) => {
    const router = useRouter();

    return (
      <div>
        {error.message}
        <button
          onClick={() => {
            // ë¼ìš°í„° ì—ëŸ¬ ê²½ê³„ë¥¼ ì¬ì„¤ì •
            reset();
          }}
        >
          retry
        </button>
      </div>
    );
  },
});
```

ì˜¤ë¥˜ê°€ ë¼ìš°íŠ¸ ë¡œë“œë¡œ ì¸í•´ ë°œìƒí•œ ê²½ìš°, `router.invalidate()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ë¼ìš°í„° ë¦¬ë¡œë“œì™€ ì—ëŸ¬ ê²½ê³„ ì¬ì„¤ì •ì„ ëª¨ë‘ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  errorComponent: ({ error, reset }) => {
    const router = useRouter();

    return (
      <div>
        {error.message}
        <button
          onClick={() => {
            // ë¼ìš°íŠ¸ë¥¼ ë¬´íš¨í™”í•˜ì—¬ ë¡œë”ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ê³  ì—ëŸ¬ ê²½ê³„ë¥¼ ì¬ì„¤ì •
            router.invalidate();
          }}
        >
          retry
        </button>
      </div>
    );
  },
});
```

### Using the default `ErrorComponent`

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”© ë˜ëŠ” ë Œë”ë§ ë¼ì´í”„ì‚¬ì´í´ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œ ë Œë”ë§ë˜ëŠ” ê¸°ë³¸ `ErrorComponent`ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë¼ìš°íŠ¸ì˜ ì˜¤ë¥˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ì¬ì •ì˜í•˜ëŠ” ê²½ìš°ì—ë„ ê¸°ë³¸ `ErrorComponent`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì˜¤ë¥˜ë¥¼ ë Œë”ë§í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤:

```tsx
// routes/posts.tsx
import { createFileRoute, ErrorComponent } from "@tanstack/react-router";

export const Route = createFileRoute("/posts")({
  loader: () => fetchPosts(),
  errorComponent: ({ error }) => {
    if (error instanceof MyCustomError) {
      // ì‚¬ìš©ì ì •ì˜ ì˜¤ë¥˜ ë©”ì‹œì§€ ë Œë”ë§
      return <div>{error.message}</div>;
    }

    // ê¸°ë³¸ ErrorComponentë¡œ í´ë°±
    return <ErrorComponent error={error} />;
  },
});
```
